const char* htmlPage = R"rawliteral(
<!DOCTYPE HTML>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HOME AUTOMATION</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #000;
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow-x: hidden;
    }
    
    /* Scrolling background effect */
    @keyframes scrollBg {
      0% { transform: translateY(0); }
      100% { transform: translateY(-100%); }
    }
    
    .bg-scroll {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 200%;
      background: linear-gradient(180deg, 
        #000 0%, 
        #1a1a1a 25%, 
        #000 50%, 
        #1a1a1a 75%, 
        #000 100%);
      animation: scrollBg 20s linear infinite;
      z-index: -1;
      opacity: 0.5;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
      position: relative;
      z-index: 1;
    }
    
    /* Header */
    header {
      text-align: center;
      margin-bottom: 80px;
      padding: 60px 20px;
      position: relative;
      overflow: hidden;
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 200%;
      height: 1px;
      background: linear-gradient(90deg, transparent, #fff, transparent);
      animation: scanLine 3s infinite;
    }
    
    @keyframes scanLine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    h1 {
      font-size: 3.5rem;
      font-weight: 300;
      letter-spacing: 4px;
      margin-bottom: 15px;
      text-transform: uppercase;
      transition: all 0.3s ease;
    }
    
    h1:hover {
      letter-spacing: 6px;
      opacity: 0.8;
    }
    
    .subtitle {
      font-size: 0.95rem;
      letter-spacing: 2px;
      color: #999;
      text-transform: uppercase;
      margin-bottom: 40px;
    }
    
    .status-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 40px;
      padding-top: 40px;
      border-top: 1px solid #333;
    }
    
    .status-card {
      padding: 20px;
      border: 1px solid #333;
      background: rgba(255, 255, 255, 0.02);
      text-align: center;
      transition: all 0.4s ease;
      cursor: pointer;
    }
    
    .status-card:hover {
      border-color: #fff;
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-5px);
    }
    
    .status-label {
      font-size: 0.8rem;
      letter-spacing: 1px;
      color: #999;
      text-transform: uppercase;
      margin-bottom: 10px;
    }
    
    .status-value {
      font-size: 1.8rem;
      font-weight: 300;
      color: #fff;
    }
    
    /* Sensors Grid */
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      margin: 80px 0;
    }
    
    .sensor-panel {
      border: 1px solid #333;
      padding: 40px;
      background: rgba(255, 255, 255, 0.01);
      transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      overflow: hidden;
    }
    
    .sensor-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.05);
      transition: left 0.5s ease;
    }
    
    .sensor-panel:hover {
      border-color: #fff;
      background: rgba(255, 255, 255, 0.05);
      transform: translateY(-10px);
    }
    
    .sensor-panel:hover::before {
      left: 100%;
    }
    
    .sensor-title {
      font-size: 1.2rem;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 25px;
      border-bottom: 1px solid #333;
      padding-bottom: 15px;
      color: #ccc;
    }
    
    .sensor-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 20px 0;
    }
    
    .sensor-value {
      font-size: 2.5rem;
      font-weight: 300;
      letter-spacing: 1px;
    }
    
    .sensor-unit {
      font-size: 0.9rem;
      color: #999;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    /* Progress Bar */
    .progress-bar {
      width: 100%;
      height: 2px;
      background: #222;
      margin: 20px 0;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: #fff;
      transition: width 0.8s ease;
    }
    
    /* Alert Status */
    .alert-status {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #333;
      font-size: 0.9rem;
      letter-spacing: 1px;
    }
    
    .status-normal { color: #fff; }
    .status-warning { color: #ffaa00; }
    .status-danger { color: #ff4444; }
    
    /* Controls Section */
    .controls-section {
      margin: 80px 0;
      padding: 40px;
      border: 1px solid #333;
      background: rgba(255, 255, 255, 0.01);
    }
    
    .controls-title {
      font-size: 1.5rem;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 40px;
      border-bottom: 1px solid #333;
      padding-bottom: 20px;
    }
    
    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }
    
    .btn {
      padding: 15px 30px;
      background: transparent;
      border: 1px solid #333;
      color: #fff;
      cursor: pointer;
      font-size: 0.9rem;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: all 0.4s ease;
      font-weight: 300;
    }
    
    .btn:hover {
      border-color: #fff;
      background: rgba(255, 255, 255, 0.08);
      transform: scale(1.02);
    }
    
    .btn:active {
      transform: scale(0.98);
    }
    
    .btn.danger:hover {
      border-color: #ff4444;
      color: #ff4444;
      box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
    }
    
    .btn.success:hover {
      border-color: #00ff88;
      color: #00ff88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
    }
    
    /* Toggle Switch */
    .toggle {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
      margin: 20px 0;
    }
    
    .toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #333;
      transition: .3s;
      border: 1px solid #555;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 24px;
      width: 24px;
      left: 3px;
      bottom: 2px;
      background-color: #fff;
      transition: .3s;
    }
    
    input:checked + .slider {
      background-color: #000;
      border-color: #fff;
    }
    
    input:checked + .slider:before {
      transform: translateX(30px);
    }
    
    /* People Counter */
    .people-counter {
      font-size: 3rem;
      font-weight: 300;
      text-align: center;
      margin: 30px 0;
      letter-spacing: 2px;
    }
    
    .counter-label {
      font-size: 0.9rem;
      color: #999;
      letter-spacing: 1px;
      text-align: center;
    }
    
    /* RFID Section */
    .rfid-section {
      background: rgba(255, 255, 255, 0.02);
      padding: 30px;
      border: 1px solid #333;
      margin: 40px 0;
    }
    
    .rfid-title {
      font-size: 1.2rem;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 20px;
      border-bottom: 1px solid #333;
      padding-bottom: 15px;
    }
    
    .card-list {
      list-style: none;
      margin: 20px 0;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .card-item {
      padding: 10px;
      border-bottom: 1px solid #222;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9rem;
      letter-spacing: 1px;
    }
    
    .card-item:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .remove-btn {
      background: #ff4444;
      border: none;
      color: #000;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.3s ease;
    }
    
    .remove-btn:hover {
      background: #ff6666;
    }
    
    /* Door Status */
    .door-section {
      text-align: center;
      padding: 40px;
      border: 1px solid #333;
      margin: 40px 0;
      background: rgba(255, 255, 255, 0.01);
    }
    
    .door-status {
      font-size: 2rem;
      margin: 20px 0;
      letter-spacing: 2px;
      font-weight: 300;
    }
    
    .door-locked { color: #ff4444; }
    .door-unlocked { color: #00ff88; }
    
    /* Footer */
    footer {
      text-align: center;
      margin-top: 100px;
      padding: 40px 0;
      border-top: 1px solid #333;
      color: #666;
      font-size: 0.85rem;
      letter-spacing: 1px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      h1 { font-size: 2.5rem; }
      .dashboard { grid-template-columns: 1fr; }
      .sensor-panel { padding: 30px 20px; }
      .controls-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="bg-scroll"></div>
  
  <div class="container">
    <header>
      <h1>HOME AUTOMATION</h1>
      <p class="subtitle">Smart Home Monitoring System</p>
      
      <div class="status-grid">
        <div class="status-card">
          <div class="status-label">System Status</div>
          <div class="status-value" id="sysStatus">ACTIVE</div>
        </div>
        <div class="status-card">
          <div class="status-label">Last Update</div>
          <div class="status-value" id="lastUpdate">--:--:--</div>
        </div>
        <div class="status-card">
          <div class="status-label">IP Address</div>
          <div class="status-value">192.168.4.1</div>
        </div>
      </div>
    </header>
    
    <!-- Environmental Sensors -->
    <div class="dashboard">
      <!-- Temperature -->
      <div class="sensor-panel">
        <div class="sensor-title">Temperature</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="tempVal">0.0</div>
            <div class="sensor-unit">Celsius</div>
          </div>
          <div style="text-align: right;">
            <div class="progress-bar">
              <div class="progress-fill" id="tempBar" style="width: 0%;"></div>
            </div>
            <div id="tempStatus" class="alert-status status-normal">NORMAL</div>
          </div>
        </div>
      </div>
      
      <!-- Humidity -->
      <div class="sensor-panel">
        <div class="sensor-title">Humidity</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="humidVal">0</div>
            <div class="sensor-unit">Percent</div>
          </div>
          <div style="text-align: right;">
            <div class="progress-bar">
              <div class="progress-fill" id="humidBar" style="width: 0%;"></div>
            </div>
            <div id="humidStatus" class="alert-status status-normal">NORMAL</div>
          </div>
        </div>
      </div>
      
      <!-- MQ2 Smoke -->
      <div class="sensor-panel">
        <div class="sensor-title">Smoke Detector (MQ2)</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="mq2Val">0</div>
            <div class="sensor-unit">PPM</div>
          </div>
          <div style="text-align: right;">
            <div id="mq2Status" class="alert-status status-normal">SAFE</div>
          </div>
        </div>
      </div>
      
      <!-- MQ3 Gas -->
      <div class="sensor-panel">
        <div class="sensor-title">Gas Detector (MQ3)</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="mq3Val">0</div>
            <div class="sensor-unit">PPM</div>
          </div>
          <div style="text-align: right;">
            <div id="mq3Status" class="alert-status status-normal">SAFE</div>
          </div>
        </div>
      </div>
      
      <!-- Motion Sensor -->
      <div class="sensor-panel">
        <div class="sensor-title">Motion Detector (PIR)</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="motionVal">NO</div>
            <div class="sensor-unit">Motion</div>
          </div>
          <div style="text-align: right;">
            <div id="motionStatus" class="alert-status status-normal">CALM</div>
          </div>
        </div>
      </div>
      
      <!-- Rain Sensor -->
      <div class="sensor-panel">
        <div class="sensor-title">Rain Detector</div>
        <div class="sensor-content">
          <div>
            <div class="sensor-value" id="rainVal">DRY</div>
            <div class="sensor-unit">Status</div>
          </div>
          <div style="text-align: right;">
            <div id="rainStatus" class="alert-status status-normal">NO RAIN</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- People Counter -->
    <div class="sensor-panel" style="grid-column: 1/-1; text-align: center;">
      <div class="sensor-title">People Count</div>
      <div class="people-counter" id="peopleCount">0</div>
      <div class="counter-label">Total People Inside</div>
    </div>
    
    <!-- Safety & Control Section -->
    <div class="controls-section">
      <div class="controls-title">System Controls</div>
      <div class="controls-grid">
        <button class="btn danger" onclick="toggleSafety()">
          <span id="safetyBtnText">Activate Safety Mode</span>
        </button>
        <button class="btn success" onclick="ringBuzzer()">Alert Sound</button>
        <button class="btn" onclick="resetCounter()">Reset Counter</button>
      </div>
      
      <div style="margin-top: 30px; border-top: 1px solid #333; padding-top: 30px;">
        <h3 style="letter-spacing: 2px; text-transform: uppercase; margin-bottom: 20px;">Safety Mode</h3>
        <div style="display: flex; align-items: center; gap: 20px;">
          <span>Enabled:</span>
          <label class="toggle">
            <input type="checkbox" id="safetyToggle" onchange="toggleSafety()">
            <span class="slider"></span>
          </label>
          <span id="safetyText" style="color: #666;">INACTIVE</span>
        </div>
      </div>
    </div>
    
    <!-- Door Control Section -->
    <div class="door-section">
      <div class="sensor-title">Smart Door Lock</div>
      <div class="door-status" id="doorStatus">LOCKED</div>
      <button class="btn success" onclick="controlDoor()" style="margin-top: 20px;">Unlock Door (5s)</button>
    </div>
    
    <!-- RFID Card Management -->
    <div class="rfid-section">
      <div class="rfid-title">RFID Card Management</div>
      <p style="font-size: 0.9rem; color: #999; margin-bottom: 20px;">Tap RFID card to add. Max 10 cards.</p>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
        <button class="btn success" onclick="addCardMode()">Add New Card</button>
        <button class="btn danger" onclick="clearAllCards()">Clear All Cards</button>
      </div>
      
      <div style="margin-top: 20px;">
        <h4 style="letter-spacing: 1px; margin-bottom: 15px;">Authorized Cards:</h4>
        <ul class="card-list" id="cardList">
          <li class="card-item" style="color: #666;">No cards registered</li>
        </ul>
      </div>
    </div>
    
    <!-- Servo Controls -->
    <div class="controls-section">
      <div class="controls-title">Servo Controls</div>
      <div class="controls-grid">
        <div>
          <h4 style="margin-bottom: 15px; letter-spacing: 1px;">Rain Cover Servo</h4>
          <div class="progress-bar">
            <div class="progress-fill" id="servo1Bar" style="width: 50%;"></div>
          </div>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button class="btn" onclick="controlServo1(0)" style="flex: 1;">Close</button>
            <button class="btn" onclick="controlServo1(180)" style="flex: 1;">Open</button>
          </div>
        </div>
      </div>
    </div>
    
    <footer>
      <p>HOME AUTOMATION SYSTEM | 2024</p>
      <p style="margin-top: 10px;">Connected via 192.168.4.1 | AJAX Update Rate: 2s</p>
    </footer>
  </div>
  
  <script>
    let sensorData = {};
    let isUpdating = false;
    let addingCard = false;
    
    function initDashboard() {
      updateDashboard();
      setInterval(updateDashboard, 2000);
    }
    
    function updateDashboard() {
      if (isUpdating) return;
      isUpdating = true;
      
      fetch('/sensorData')
        .then(r => r.json())
        .then(data => {
          sensorData = data;
          updateDisplay(data);
          updateTime();
          isUpdating = false;
        })
        .catch(e => {
          console.error('Error:', e);
          isUpdating = false;
        });
    }
    
    function updateDisplay(data) {
      // Temperature
      document.getElementById('tempVal').textContent = data.temperature.toFixed(1);
      document.getElementById('tempBar').style.width = Math.min(data.temperature / 50 * 100, 100) + '%';
      let tempStatus = 'NORMAL';
      if (data.temperature > 35) tempStatus = 'HOT';
      if (data.temperature < 5) tempStatus = 'COLD';
      document.getElementById('tempStatus').textContent = tempStatus;
      document.getElementById('tempStatus').className = 'alert-status ' + (data.temperature > 35 ? 'status-danger' : 'status-normal');
      
      // Humidity
      document.getElementById('humidVal').textContent = Math.round(data.humidity);
      document.getElementById('humidBar').style.width = data.humidity + '%';
      let humidStatus = 'NORMAL';
      if (data.humidity > 80) humidStatus = 'HIGH';
      if (data.humidity < 30) humidStatus = 'LOW';
      document.getElementById('humidStatus').textContent = humidStatus;
      document.getElementById('humidStatus').className = 'alert-status ' + (data.humidity > 80 || data.humidity < 30 ? 'status-warning' : 'status-normal');
      
      // MQ2
      document.getElementById('mq2Val').textContent = data.mq2;
      document.getElementById('mq2Status').className = 'alert-status ' + (data.mq2 > 1500 ? 'status-danger' : 'status-normal');
      document.getElementById('mq2Status').textContent = data.mq2 > 1500 ? 'ALERT!' : 'SAFE';
      
      // MQ3
      document.getElementById('mq3Val').textContent = data.mq3;
      document.getElementById('mq3Status').className = 'alert-status ' + (data.mq3 > 1500 ? 'status-danger' : 'status-normal');
      document.getElementById('mq3Status').textContent = data.mq3 > 1500 ? 'ALERT!' : 'SAFE';
      
      // Motion
      document.getElementById('motionVal').textContent = data.motionDetected ? 'YES' : 'NO';
      document.getElementById('motionStatus').className = 'alert-status ' + (data.motionDetected ? 'status-warning' : 'status-normal');
      document.getElementById('motionStatus').textContent = data.motionDetected ? 'DETECTED' : 'CALM';
      
      // Rain
      document.getElementById('rainVal').textContent = data.rainDetected ? 'RAINING' : 'DRY';
      document.getElementById('rainStatus').textContent = data.rainDetected ? 'RAINING' : 'NO RAIN';
      
      // People Count
      document.getElementById('peopleCount').textContent = data.peopleCount;
      
      // Servo Position
      document.getElementById('servo1Bar').style.width = (data.servo1Position / 180 * 100) + '%';
      
      // Door Status
      document.getElementById('doorStatus').textContent = data.doorUnlocked ? 'UNLOCKED' : 'LOCKED';
      document.getElementById('doorStatus').className = 'door-status ' + (data.doorUnlocked ? 'door-unlocked' : 'door-locked');
      
      // Safety Mode
      document.getElementById('safetyToggle').checked = data.safetyMode;
      document.getElementById('safetyText').textContent = data.safetyMode ? 'ACTIVE' : 'INACTIVE';
      document.getElementById('safetyBtnText').textContent = data.safetyMode ? 'Deactivate Safety Mode' : 'Activate Safety Mode';
      
      // Update card list
      if (data.cards) {
        const cardList = document.getElementById('cardList');
        cardList.innerHTML = '';
        if (data.cards.length === 0) {
          cardList.innerHTML = '<li class="card-item" style="color: #666;">No cards registered</li>';
        } else {
          data.cards.forEach((card, idx) => {
            const item = document.createElement('li');
            item.className = 'card-item';
            item.innerHTML = `<span>${card}</span><button class="remove-btn" onclick="removeCard('${card}')">Remove</button>`;
            cardList.appendChild(item);
          });
        }
      }
    }
    
    function updateTime() {
      const now = new Date();
      document.getElementById('lastUpdate').textContent = now.toLocaleTimeString('en-US', {hour12: false});
    }
    
    function toggleSafety() {
      fetch('/toggleSafety').then(r => r.json()).then(() => updateDashboard());
    }
    
    function ringBuzzer() {
      fetch('/buzzer').then(r => r.json()).then(() => updateDashboard());
    }
    
    function resetCounter() {
      fetch('/resetCounter').then(r => r.json()).then(() => updateDashboard());
    }
    
    function controlDoor() {
      fetch('/doorControl').then(r => r.json()).then(() => updateDashboard());
    }
    
    function controlServo1(angle) {
      fetch('/servoControl?angle=' + angle).then(r => r.json()).then(() => updateDashboard());
    }
    
    function addCardMode() {
      addingCard = true;
      alert('Bring RFID card close to reader...');
    }
    
    function removeCard(cardId) {
      fetch('/removeCard?id=' + cardId).then(r => r.json()).then(() => updateDashboard());
    }
    
    function clearAllCards() {
      if (confirm('Clear all authorized cards?')) {
        fetch('/clearCards').then(r => r.json()).then(() => updateDashboard());
      }
    }
    
    document.addEventListener('DOMContentLoaded', initDashboard);
  </script>
</body>
</html>
)rawliteral";